<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title> this is beta</title>
  </head>
  <body>
	tes download csv
	<script>
		var rawsensor=[
			['timestamp','gx','gy','gz','ax','ay','az'],
		];
		var count=0;
		var ax = 0;
		var ay = 0;
		var az = 0;
		var gx = 0;
		var gy = 0;
		var gz = 0;	
		var time = 0;
		//rawsensor.push(['11.00.00',1,1,1,1,1,1])

		if (window.DeviceMotionEvaent == undefined) {
			//No accelerometer is present. Use buttons. 
			console.log('no');
		}
		else {
			console.log('yes');
			window.addEventListener("devicemotion", accelerometerUpdate, true);
		}
		function accelerometerUpdate(event) {
			ax = event.acceleration.x;
			ay = event.acceleration.y;
			az = event.acceleration.z;
			gx = event.rotationRate.beta;
			gy = event.rotationRate.gamma;
			gz = event.rotationRate.alpha;	
			time = new Date().getTime(); 
			let counting = document.getElementById("itung");
			//console.log(count);
			if (count>=0){
				//rawsensor.push([time,gx,gy,gz,ax,ay,az]);
				rawsensor.push([time,gx,gy,gz,ax,ay,az]);
				count++;
				//console.log(count);
			}
			if (count==3000){
				let csvContent = "data:text/csv;charset=utf-8," + rawsensor.map(e => e.join(",")).join("\n");
				var encodedUri = encodeURI(csvContent);
				var link = document.createElement("a");
				link.setAttribute("href", encodedUri);
				link.setAttribute("download", "dataku.csv");
				document.body.appendChild(link); // Required for FF
				link.click(); // This will download the data file named "my_data.csv".
				count=0;
			}
			counting.innerHTML=count;
		}
	</script>
	<p id="itung">counting</p>
  </body>
</html>
