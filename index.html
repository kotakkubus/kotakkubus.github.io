<!doctype html>
<html lang="en">
  <head>
	<script src="csv_generator.js"></script>
    <meta charset="utf-8" />
    <title> this is beta</title>
  </head>
  <body>
	tes download csv
	<script>
		const rawsensor=[
			['timestamp','gx','gy','gz','ax','ay','az'],
			['00.00.00',0,0,0,0,0,0],
		];
		var count=0;
		rawsensor.push(['11.00.00',1,0,0,0,0,0])
		let csvContent = "data:text/csv;charset=utf-8," 
			+ rawsensor.map(e => e.join(",")).join("\n");
		
		if (window.DeviceMotionEvent == undefined) {
			//No accelerometer is present. Use buttons. 
			console.log('no');
		}
		else {
			console.log('yes');
			window.addEventListener("devicemotion", accelerometerUpdate, true);
		}
		function accelerometerUpdate(event) {
			var ax = event.acceleration.x;
			var ay = event.acceleration.y;
			var az = event.acceleration.z;
			var gx = event.rotationRate.beta;
			var gy = event.rotationRate.gamma;
			var gz = event.rotationRate.alpha;	
			var time = new Date().getTime(); 
			let counting = document.getElementById("itung");
			//console.log(count);
			if (count>=1&&count<2000){
				rawsensor.push([time,gx,gy,gz,ax,ay,az]);
				count++;
			}
			if (count==2000){
				var encodedUri = encodeURI(csvContent);
				var link = document.createElement("a");
				link.setAttribute("href", encodedUri);
				link.setAttribute("download", "dataku.csv");
				document.body.appendChild(link); // Required for FF
				link.click(); // This will download the data file named "my_data.csv".
				count=0;
			}
			counting.innerHTML=count;
		}
	</script>
	<p id="itung">counting</p>
  </body>
</html>
